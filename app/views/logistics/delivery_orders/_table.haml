#wid-id-0.jarviswidget.jarviswidget-color-darken{"data-widget-editbutton" => "false", "data-widget-deletebutton" => "false"}
  %header
    %span.widget-icon
      %i.fa.fa-table
    %h2 Lista de Ordenes de Suministros
  / widget div
  %div
    / widget edit box
    .jarviswidget-editbox
      / This area used as dropdown edit box
    / end widget edit box
    / widget content
    .widget-body.no-padding
      .widget-body-toolbar
      #dt_basic_wrapper.dataTables_wrapper.form-inline{:role => 'grid'}
        .dt-top-row
          #dt_basic_length.dataTables_length
            %span.smart-form
              %label.select{style: "width:60px"}
                %select{"aria-controls" => "dt_basic", name: "dt_basic_length", size: "1"}
                  %option{selected: "selected", value: "10"} 10
                  %option{value: "25"} 25
                  %option{value: "50"} 50
                  %option{value: "100"} 100
                %i
          #dt_basic_filter.dataTables_filter
            .input-group
              %span.input-group-addon
                %i.fa.fa-search
              %input.form-control#filter-search{"aria-controls" => "dt_basic", placeholder: "Filter", type: "text"}
        .dt-wrapper
          %table#dt_basic.table.table-striped.table-bordered.table-hover
            %thead
              %tr
                %th Código
                %th Estado
                %th Fecha de Emisión
                %th Fecha Programada
                %th Responsable
                %th Descripcion
                %th Acciones
            %tbody
              - @deliveryOrders.each do |delivery|
                %tr
                  %td 
                    = delivery.id.to_s.rjust(5, '0')
                  - case delivery.state
                    - when 'pre_issued'
                      %td
                        %span.label.label-primary
                          = translate_delivery_order_state(delivery.state)
                    - when 'issued'
                      %td
                        %span.label.label-warning{:style => "background-color: #FF7A00;"}
                          = translate_delivery_order_state(delivery.state)
                    - when 'revised'
                      %td
                        %span.label.label-warning
                          = translate_delivery_order_state(delivery.state)
                    - when 'canceled'
                      %td
                        %span.label.label-danger
                          = translate_delivery_order_state(delivery.state)
                    - when 'approved'
                      %td
                        %span.label.label-success{:style => "background-color: #25CA25;"}
                          = translate_delivery_order_state(delivery.state)
                  %td
                    = delivery.date_of_issue
                  %td
                    = delivery.scheduled
                  %td
                    = delivery.user.first_name + " " + delivery.user.last_name
                  %td
                    = truncate(delivery.description, :length => 60, :omission => '...')
                  %td
                    %a.btn.btn-success.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}', 'content', null, null, 'GET')"}
                      Ver Detalle
                    - case delivery.state
                      - when 'pre_issued'
                        %a.btn.btn-warning.btn-xs{:onclick => "javascript:load_url_ajax('#{edit_logistics_delivery_order_path(delivery.id)}', 'content', null, null, 'GET')"}
                          Editar
                        %a.btn.btn-info.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=issued', 'content', null, null, 'GET')"}
                          Emitir
                        %a.btn.btn-danger.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=canceled', 'content', null, null, 'GET')"}
                          Anular
                        %a.btn.btn-danger.btn-xs{:target => "_blank", :href => "#{delivery_order_pdf_logistics_delivery_order_path(delivery.id)}.pdf"}
                          Ver PDF
                      - when 'issued'
                        %a.btn.btn-info.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=revised', 'content', null, null, 'GET')"}
                          Dar visto bueno
                        %a.btn.btn-info.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=observed', 'content', null, null, 'GET')"}
                          Observar
                        %a.btn.btn-danger.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=canceled', 'content', null, null, 'GET')"}
                          Anular
                        %a.btn.btn-danger.btn-xs{:target => "_blank", :href => "#{delivery_order_pdf_logistics_delivery_order_path(delivery.id)}.pdf"}
                          Ver PDF
                      - when 'revised'
                        %a.btn.btn-info.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=issued', 'content', null, null, 'GET')"}
                          Volver a Emitir
                        %a.btn.btn-primary.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=approved', 'content', null, null, 'GET')"}
                          Aprobar
                        %a.btn.btn-danger.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=canceled', 'content', null, null, 'GET')"}
                          Anular
                        %a.btn.btn-danger.btn-xs{:target => "_blank", :href => "#{delivery_order_pdf_logistics_delivery_order_path(delivery.id)}.pdf"}
                          Ver PDF
                      - when 'canceled'
                        %a.btn.btn-danger.btn-xs{:target => "_blank", :href => "#{delivery_order_pdf_logistics_delivery_order_path(delivery.id)}.pdf"}
                          Ver PDF
                      - when 'approved'
                        %a.btn.btn-info.btn-xs{:href => "##{logistics_delivery_order_path(delivery.id)}?state_change=revised"}
                          Volver a Visto Bueno
                        %a.btn.btn-danger.btn-xs{:target => "_blank", :href => "#{delivery_order_pdf_logistics_delivery_order_path(delivery.id)}.pdf"}
                          Ver PDF
                        %a.btn.btn-danger.btn-xs{:onclick => "javascript:load_url_ajax('#{logistics_delivery_order_path(delivery.id)}?state_change=canceled', 'content', null, null, 'GET')"}
                          Anular


:javascript
  // DO NOT REMOVE : GLOBAL FUNCTIONS!
  pageSetUp();
  
  // PAGE RELATED SCRIPTS

  loadDataTableScripts();
  function loadDataTableScripts() {

    loadScript("#{ asset_path 'plugin/datatables/jquery.dataTables-cust.min', type: :javascript }", dt_2);

    function dt_2() {
      loadScript("#{ asset_path 'plugin/datatables/ColReorder.min', type: :javascript }", dt_3);
    }

    function dt_3() {
      loadScript("#{ asset_path 'plugin/datatables/FixedColumns.min.js', type: :javascript }", dt_4);
    }

    function dt_4() {
      loadScript("#{ asset_path 'plugin/datatables/ColVis.min', type: :javascript }", dt_5);
    }

    function dt_5() {
      loadScript("#{ asset_path 'plugin/datatables/ZeroClipboard', type: :javascript }", dt_6);
    }

    function dt_6() {
      loadScript("#{ asset_path 'plugin/datatables/media/js/TableTools.min', type: :javascript }", dt_7);
    }

    function dt_7() {
      loadScript("#{ asset_path 'plugin/datatables/DT_bootstrap', type: :javascript }", runDataTables);
    }

  }

  function runDataTables() {

    /*
     * BASIC
     */
    $('#dt_basic').dataTable({
      "sPaginationType" : "bootstrap_full"
    });

    /* END BASIC */

    /* Add the events etc before DataTables hides a column */
    $("#dt_basic thead input").keyup(function() {
      oTable.fnFilter(this.value, oTable.oApi._fnVisibleToColumnIndex(oTable.fnSettings(), $("thead input").index(this)));
    });

    $("#dt_basic thead input").each(function(i) {
      this.initVal = this.value;
    });
    $("#dt_basic thead input").focus(function() {
      if (this.className == "search_init") {
        this.className = "";
        this.value = "";
      }
    });
    $("#dt_basic thead input").blur(function(i) {
      if (this.value == "") {
        this.className = "search_init";
        this.value = this.initVal;
      }
    });   
    

    var oTable = $('#datatable_fixed_column').dataTable({
      "sDom" : "<'dt-top-row'><'dt-wrapper't><'dt-row dt-bottom-row'<'row'<'col-sm-6'i><'col-sm-6 text-right'p>>",
      //"sDom" : "t<'row dt-wrapper'<'col-sm-6'i><'dt-row dt-bottom-row'<'row'<'col-sm-6'i><'col-sm-6 text-right'>>",
      "oLanguage" : {
        "sSearch" : "Search all columns:"
      },
      "bSortCellsTop" : true
    });   
    


    /*
     * COL ORDER
     */
    $('#datatable_col_reorder').dataTable({
      "sPaginationType" : "bootstrap",
      "sDom" : "R<'dt-top-row'Clf>r<'dt-wrapper't><'dt-row dt-bottom-row'<'row'<'col-sm-6'i><'col-sm-6 text-right'p>>",
      "fnInitComplete" : function(oSettings, json) {
        $('.ColVis_Button').addClass('btn btn-default btn-sm').html('Columns <i class="icon-arrow-down"></i>');
      }
    });
    
    /* END COL ORDER */

    /* TABLE TOOLS */
    $('#datatable_tabletools').dataTable({
      "sDom" : "<'dt-top-row'Tlf>r<'dt-wrapper't><'dt-row dt-bottom-row'<'row'<'col-sm-6'i><'col-sm-6 text-right'p>>",
      "oTableTools" : {
        "aButtons" : ["copy", "print", {
          "sExtends" : "collection",
          "sButtonText" : 'Save <span class="caret" />',
          "aButtons" : ["csv", "xls", "pdf"]
        }],
        "sSwfPath" : "#{ asset_path 'javascript/plugin/datatables/media/swf/copy_csv_xls_pdf.swf'}"
      },
      "fnInitComplete" : function(oSettings, json) {
        $(this).closest('#dt_table_tools_wrapper').find('.DTTT.btn-group').addClass('table_tools_group').children('a.btn').each(function() {
          $(this).addClass('btn-sm btn-default');
        });
      }
    });
    
    /* END TABLE TOOLS */

  }