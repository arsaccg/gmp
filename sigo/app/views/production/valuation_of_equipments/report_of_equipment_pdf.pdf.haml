%html
  %head
    %meta{charset: "utf-8"}
    = wicked_pdf_stylesheet_link_tag "bootstrap.min", media: "screen", rel: "stylesheet", type: "text/css"
  %body
    = image_tag @company.avatar.url, alt: "#{@company.name}"
    %br
    %br
    %div
      .widget-body
        %table.panel.panel-primary{ style: "height: 150px; width: 850px;margin: 0 auto" }
          %thead.panel-heading
            %tr
              %th{'colspan' => 4, "style"=>"text-align:center;font-size: large"}=@valuationofequipment.name.to_s+" - VALORIZACIÓN N°"+ ' ' + @valuationofequipment.code

          %tbody{:style=>"font-size:small;"}
            %tr{"bgcolor"=>"#ECF3F8"}
              %th{"style"=>"color:#5f5f5f;text-align:center;"} OBRA:
              %th{'colspan' => 3, "style"=>"color:#5f5f5f;"}= CostCenterDetail.find_by_cost_center_id(@cc).name.to_s
            %tr
              %th{"style"=>"color:#5f5f5f;text-align:center;"} Razón Social:
              %th{'colspan' => 3, "style"=>"font-weight: normal;color:#5f5f5f;"}= @valuationofequipment.name.to_s
            %tr{"bgcolor"=>"#ECF3F8"}
              %th{"style"=>"color:#5f5f5f;text-align:center;"} RUC:
              %th{'colspan' => 3, "style"=>"font-weight: normal;color:#5f5f5f;"}= Entity.find_by_name(@valuationofequipment.name).ruc.to_s
            %tr{"bgcolor"=>"#3276B1"}
              %th{"style"=>"color:white;text-align:center;width: 15%"} Monto contratado
              %th{"style"=>"color:white;text-align:center"} Adelanto
              %th{"style"=>"color:white;text-align:center"} Amortización Acumulada
              %th{"style"=>"color:white;text-align:center"} Saldo
            %th{"style"=>"color:#5f5f5f;text-align:center"}= number_to_currency(@valuationofequipment.hired_amount, unit: 'S/. ', precision: 2)
            %th{"style"=>"color:#5f5f5f;text-align:center"}= number_to_currency(@valuationofequipment.advances, unit: 'S/. ', precision: 2)     
            %th{"style"=>"color:#5f5f5f;text-align:center"}= number_to_currency(@valuationofequipment.accumulated_amortization, unit: 'S/. ', precision: 2)
            %th{"style"=>"color:#5f5f5f;text-align:center"}= number_to_currency(@valuationofequipment.balance, unit: 'S/. ', precision: 2)
    %br
    %h1.page-title.txt-color-blueDark{style: "font-size:230%;"}= @name2
    %table.panel.panel-primary.table-bordered{ style: "width: 850px" }
      %thead.panel-heading
        %tr
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} #
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} #Parte
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} Fecha
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} H.inicio
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} H.fin
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} H.horas
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} H.Efectivas
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} Suministro
          %th{style: "height:35px;text-align:center;vertical-align: middle;"} Combustible
      %tbody
      - index = 1
      - status = false
      - row1 = ""
      - row2 = ""
      - row3 = ""
      - row4 = ""
      - row5 = ""
      - row6 = ""
      - row7 = ""
      - row8 = ""
      - @dias_habiles.each do |dia|
        - @poe_array.each do |workerDetail|
          -if workerDetail[1]==dia
            - if !status
              - status = true
              - row1 = workerDetail[0]
              - row2 = workerDetail[1]
              - row3 = workerDetail[2]
              - row4 = workerDetail[3]
              - row5 = workerDetail[4]
              - row6 = workerDetail[5]
              - row7 = workerDetail[6]
              - row8 = workerDetail[7]
              - break
          -else
            - status = false
            - row1 = '--'
            - row2 = dia
            - row3 = '--'
            - row4 = '--'
            - row5 = '--'
            - row6 = '--'
            - row7 = '--'
            - row8 = '--'
        %tr{"style" =>"font-size:75%;"}
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle;padding-top: 7px; padding-bottom: 7px;'}
            = index
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row1
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row2
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row3
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row4
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row5
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row6
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row7
          %th{'style' => 'font-weight: normal;text-align:center;vertical-align: middle'}
            = row8
        - index += 1
      %tr{"bgcolor"=>"#ECF3F8"}
        %th{'colspan' => 5}
          TOTAL
        %th{'style' => 'text-align:center;vertical-align: middle'}= sprintf('%.2f',@totaldif)
        %th{'style' => 'text-align:center;vertical-align: middle'}= sprintf('%.2f',@totaltotalhours)
        %th
        %th{'style' => 'text-align:center;vertical-align: middle'}= sprintf('%.2f',@totalfuel_amount)