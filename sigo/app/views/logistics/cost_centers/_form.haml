#wid-id-0.jarviswidget{"data-widget-colorbutton" => "false", "data-widget-editbutton" => "false"}
  %header
    %span.widget-icon
      %i.fa.fa-eye
    %h2 Centro de Costo
  .widget-body
    = simple_form_for([:logistics, @costCenter], html: {class: 'form-horizontal smart-form', autocomplete: 'off' }) do |f|
      %input{"style"=>"display:none;", value: "#{@comp}", :name =>"companyID"}
      %fieldset
        .row
          %section.col.col-6
            %label.label Código
            %label.input{for: "code"}
              %i.icon-append.fa.fa-superscript
              = f.input :code, placeholder: "Código", input_html: { class: 'form-control' }, label: false
        .row
          %section.col.col-10
            %label.label Nombre
            %label.input{for: "text-field"}
              %i.icon-append.fa.fa-user
              = f.input :name, placeholder: "Nombre del sector", input_html: { class: 'form-control' }, label: false
        .row
          %section.col.col-10
            %label.label Compania
            %label.input{for: "company_id"}
              -if @action == "edit"
                %select.form-control#category-select{:name =>"cost_center[company_id]", :style => "width:100%;padding: 0;border: none;"}
                  %option{:value => nil} Seleccione una compañía
                  - @companies.each do |company|
                    %option{:value => "#{company.id}", :selected => "#{@costCenter.company_id}"=="#{company.id}"}
                      = company.name
              -else
                %select.form-control#category-select{:name =>"cost_center[company_id]", :style => "width:100%;padding: 0;border: none;"}
                  - @companies.each do |company|
                    - if @comp.to_i == company.id
                      %option{:value => "#{company.id}", :rel => "", :selected => true}
                        = company.name
                    - else
                      %option{:value => "#{company.id}", :rel => ""}
                        = company.name
        -if @action !="edit"
          .row
            %section.col.col-10
              %label Fecha de Inicio
              %input#startdate2.string.optional.form-control{'name'=>"startdate2", type: "date"}

        .row
          %section.col.col-10
            %label Tipo de Centro de Costo
            %select.form-control#speciality_select{:name =>"cost_center[speciality]", :style => "width:100%;padding: 0;border: none;"}
              %option{:value => nil} Seleccione una especialidad
              %option{:value => "saneamiento", :selected => "#{@costCenter.speciality}"=="saneamiento"}
                Saneamiento
              %option{:value => "electrico", :selected => "#{@costCenter.speciality}"=="electrico"}
                Eléctrico
              %option{:value => "civil", :selected => "#{@costCenter.speciality}"=="civil"}
                Civil
              %option{:value => "administracion", :selected => "#{@costCenter.speciality}"=="administracion"}
                Administración
        .row
          %section.col.col-10
            %label Activo
            =f.input :active, :type => "checkbox", :label => false
          
      %footer
        -if @action !="edit"
          %a#smart-mod-eg1.btn.btn-success{href: "#"} Guardar
        -else
          %button.btn.btn-primary{type: "submit"}
            %i.fa.fa-save
              Guardar

:javascript
  $(document).ready(function () {
    $("select").select2();
    $("#cost_center_active").css("position","relative").css("left","0");

    if($('form[id^="edit_"]').length > 0) {
      submit_validate($('form[id^="edit_"]'));
    }else{
      submit_validate($('#new_cost_center'));
    }
  });

  function submit_validate(form){
    $(form['selector']).ajaxForm({
      beforeSubmit: function() {
        $(form['selector']).validate({
          // Rules for form validation
          rules : {
            'cost_center[code]' : {
              required : true
            },
            'startdate2' : {
              required : true
            },
            'cost_center[name]' : {
              required : true
            }

          },

          // Messages for form validation
          messages : {
            'cost_center[code]' : {
              required : '(*)'
             },
            'startdate2' : {
              required : '(*)'
            },
            'cost_center[name]' : {
              required : '(*)'
             }

          },

          // Do not change code below
          errorPlacement : function(error, element) {
            error.insertAfter(element.parent());
          }
        });
        // Remove all Help-inLine
        $(".help-inline").remove();
        // Client Valid
        return $(form['selector']).valid();
      },
      target: '#content',
      success: function (data){
        $(".help-inline").parent().addClass("state-error");
      },
      error: function(xhr, status, error) {
      }
    });
  }

  $("#smart-mod-eg1").click(function(e) {
    var diasSemana = new Array("Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo");
    var g=new Date(Date.parse($("#startdate2").val()));
    $.SmartMessageBox({
      title : "Verificación",
      content : "Los días en que comenzaran las semanas es : " + diasSemana[g.getDay()] + ". ¿Está seguro?",
      buttons : '[No][Yes]'
    }, function(ButtonPressed) {
      if (ButtonPressed === "Yes") {
        $('#new_cost_center').submit();
        $.smallBox({
          title : "Exito",
          content : "<i class='fa fa-clock-o'></i> <i>Centro de Costo creado satisfactoriamente.</i>",
          color : "#659265",
          iconSmall : "fa fa-check fa-2x fadeInRight animated",
          timeout : 4000
        });
      }
      if (ButtonPressed === "No") {
        $.smallBox({
          title : "Aviso",
          content : "<i class='fa fa-clock-o'></i> <i>Escoja el día en que comenzarán las semanas</i>",
          color : "#C46A69",
          iconSmall : "fa fa-times fa-2x fadeInRight animated",
          timeout : 4000
        });
      }

    });
    e.preventDefault();
  })