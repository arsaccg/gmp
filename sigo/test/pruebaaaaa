def self.get_workers_empleados(typeofworker, cost_center_id, display_length, pager_number, keyword = '')
    result = Array.new
    if keyword != '' && pager_number != 'NaN'
      part_people = ActiveRecord::Base.connection.execute("
        SELECT wo.id, CONCAT(ent.paternal_surname, ' ' ,ent.maternal_surname, ', ' ,ent.name), pow.name, ent.dni, wo.state, wc.end_date, wc.end_date_2
        FROM workers wo, entities ent, position_workers pow, worker_contracts wc 
        WHERE wo.entity_id = ent.id
        AND wo.position_worker_id = pow.id
        AND wo.id = wc.worker_id
        AND wc.status = 1
        AND wo.typeofworker LIKE '"+typeofworker.to_s+"' 
        AND wo.cost_center_id = " + cost_center_id.to_s + " 
        AND (wo.id LIKE '%" + keyword + "%' OR ent.name LIKE '%" + keyword + "%' OR ent.paternal_surname LIKE '%" + keyword + "%' OR ent.maternal_surname LIKE '%" + keyword + "%' OR pow.name LIKE '%" + keyword + "%' OR wo.dni LIKE '%" + keyword + "%' OR ent.date_of_birth LIKE '%" + keyword + "%' OR ent.address LIKE '%" + keyword + "%' OR wo.state LIKE '%" + keyword + "%') 
        ORDER BY wo.id ASC 
        LIMIT " + display_length + " 
        OFFSET " + pager_number
      )
    elsif pager_number != 'NaN'
      part_people = ActiveRecord::Base.connection.execute("
        SELECT wo.id, CONCAT(ent.paternal_surname, ' ' ,ent.maternal_surname, ', ' ,ent.name), pow.name, ent.dni, wo.state, wc.end_date, wc.end_date_2
        FROM workers wo, entities ent, position_workers pow, worker_contracts wc 
        WHERE wo.entity_id = ent.id
        AND wo.position_worker_id = pow.id
        AND wo.id = wc.worker_id
        AND wc.status = 1
        AND wo.typeofworker LIKE '"+typeofworker.to_s+"' 
        AND wo.cost_center_id = " + cost_center_id.to_s + " 
        ORDER BY wo.id ASC 
        LIMIT " + display_length + " 
        OFFSET " + pager_number
      )
    else
      part_people = ActiveRecord::Base.connection.execute("
        SELECT wo.id, CONCAT(ent.paternal_surname, ' ' ,ent.maternal_surname, ', ' ,ent.name), pow.name, ent.dni, wo.state, wc.end_date, wc.end_date_2
        FROM workers wo, entities ent, position_workers pow, worker_contracts wc 
        WHERE wo.entity_id = ent.id
        AND wo.position_worker_id = pow.id
        AND wo.id = wc.worker_id
        AND wc.status = 1
        AND wo.typeofworker LIKE '"+typeofworker.to_s+"' 
        AND wo.cost_center_id = " + cost_center_id.to_s + " 
        ORDER BY wo.id ASC 
        LIMIT " + display_length
      )
    end

    part_people.each do |part_person|
      if part_person[4]=="working"
        result << [
          part_person[0], 
          part_person[3],
          part_person[1], 
          part_person[2], 
          "<p style='text-align: center;'>"+"-"+"</p>", 
          "Trabajando",
          "<a class='btn btn-success btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "','content',null,null,'GET')> Ver Información </a> " + "<a class='btn btn-primary btn-xs' onclick=javascript:load_url_ajax('/production/workers/"+part_person[0].to_s+"/register','content',{worker_id:'" + part_person[0].to_s + "'},null,'GET')>Registrar</a>" + "<a class='btn btn-warning btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "/edit','content',null,null,'GET')> Editar </a> " + "<a class='btn btn-danger btn-xs' data-onclick=javascript:delete_to_url('/production/workers/" + part_person[0].to_s + "','content','/production/workers/') data-placement='left' data-popout='true' data-singleton='true' data-title='Esta seguro de eliminar el trabajador N°" + part_person[0].to_s + "?' data-toggle='confirmation' data-original-title='' title=''> Eliminar </a>"
        ]
      elsif part_person[4]=="registered"
        result << [
          part_person[0], 
          part_person[3],
          part_person[1], 
          part_person[2], 
          "<p style='text-align: center;'>"+"-"+"</p>", 
          "Registrado",
          "<a class='btn btn-success btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "','content',null,null,'GET')> Ver Información </a> " + "<a class='btn btn-primary btn-xs' onclick=javascript:part_contract("+part_person[0].to_s+")>Dar Alta</a>" + "<a class='btn btn-warning btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "/edit','content',null,null,'GET')> Editar </a> "
        ]
      elsif part_person[4]=="active"
        result << [
          part_person[0], 
          part_person[3],
          part_person[1], 
          part_person[2], 
          part_person[5], 
          "Activo",
          "<a class='btn btn-success btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "','content',null,null,'GET')> Ver Información </a> " + "<a class='btn btn-primary btn-xs' onclick=javascript:part_worker("+part_person[0].to_s+")>Dar Baja</a>" + "<a class='btn btn-info btn-xs' onclick=javascript:load_url_ajax('/production/worker_contracts','content',{worker_id:'" + part_person[0].to_s + "'},null,'GET')>Contratos</a>" + "<a class='btn btn-warning btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "/edit','content',null,null,'GET')> Editar </a> "
        ]
      elsif part_person[4]=="ceased"
        result << [
          part_person[0], 
          part_person[3],
          part_person[1], 
          part_person[2], 
          part_person[6], 
          "Cesado",
          "<a class='btn btn-success btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "','content',null,null,'GET')> Ver Información </a> "
        ]
      else
        result << [
          part_person[0], 
          part_person[3],
          part_person[1], 
          part_person[2], 
          part_person[4],
          "<p style='text-align: center;'>"+"-"+"</p>", 
          "<a class='btn btn-success btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "','content',null,null,'GET')> Ver Información </a> " + "<a class='btn btn-info btn-xs' onclick=javascript:load_url_ajax('/production/worker_contracts','content',{worker_id:'" + part_person[0].to_s + "'},null,'GET')>Contratos</a>" + "<a class='btn btn-warning btn-xs' onclick=javascript:load_url_ajax('/production/workers/" + part_person[0].to_s + "/edit','content',null,null,'GET')> Editar </a> " + "<a class='btn btn-danger btn-xs' data-onclick=javascript:delete_to_url('/production/workers/" + part_person[0].to_s + "','content','/production/workers/') data-placement='left' data-popout='true' data-singleton='true' data-title='Esta seguro de eliminar el trabajador N°" + part_person[0].to_s + "?' data-toggle='confirmation' data-original-title='' title=''> Eliminar </a>"
        ]
      end
    end

    return result
  end